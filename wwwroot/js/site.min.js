function openFolder(n,t,i,r){n.off("click",".folder-node");var u=t.data("path")+"/"+t.data("title");i.data("status")==="closed"?(i.data("status","opened"),i.addClass("glyphicon-folder-open").removeClass("glyphicon-folder-close"),getFileSystem(u,r,function(n){var i=generateListHtml(n,t.data("depth")+1);t.after(i)},function(){letToOpenFolder(n,r)})):i.data("status")==="opened"&&(i.data("status","closed"),i.addClass("glyphicon-folder-close").removeClass("glyphicon-folder-open"),$('li[data-path^="'+u+'"]').remove(),letToOpenFolder(n,r))}function letToOpenFolder(n,t){n.on("click",".folder-node",function(){var i=$(this).closest("li"),r=$(this);openFolder(n,i,r,t)})}function generateListHtml(n,t){var i="",r=t*"20";return $.each(n,function(n,u){if(i+='<li class="list-group-item node-tree" data-path="'+u.path+'" data-title="'+u.title+'" data-depth="'+t+'">',i+=u.type==="folder"?'<div class="folder-node glyphicon glyphicon-folder-close text-right" style="width: '+r+'px;" data-status="closed"><\/div>':'<div class="file-node glyphicon" style="width: '+r+'px;"><\/div>',i+='<span class="icon node-icon"><\/span>'+u.title,u.type==="file"){var f="/Upload/DownloadFile?"+$.param({path:u.path,fileName:u.title});i+='<a class="pull-right" href="'+f+'">Download<\/a>'}i+="<\/li>"}),i}function getFileSystem(n,t,i,r){$.ajax({url:t,method:"post",data:{path:n},dataType:"json",success:function(n){i(n)},complete:function(n){r(n)}})}$(function(){Dropzone.options.fileUploadForm={autoProcessQueue:!1,maxFilesize:5,addRemoveLinks:!0,parallelUploads:5,init:function(){var n=this,t;n.options.addRemoveLinks=!0;n.options.dictRemoveFile="Remove";n.on("addedfile",function(){});n.on("sending",function(){$(".meter").show()});t=document.querySelector("#upload-button");t.addEventListener("click",function(){n.processQueue()})}}});$(function(){var n=$("#tree"),t;n.length&&(t="/Home/ListFoldersAndFiles",getFileSystem("",t,function(t){var i=generateListHtml(t,1);n.html("<ul>"+i+"<\/ul>")},function(){}),letToOpenFolder(n,t))});$(function(){var n=$("#folder-tree"),t;n.length&&(t="/Home/ListFolders",getFileSystem("",t,function(t){var i=generateListHtml(t,1);n.html("<ul>"+i+"<\/ul>")},function(){}),letToOpenFolder(n,t))});